(window["webpackJsonpvelan-tiles"]=window["webpackJsonpvelan-tiles"]||[]).push([[15],{135:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n={endpoints:{basePath:"http://www.velanapp.in/velan/api.php?",login:"validateAdminLogin",users:{list:"getUsers",add:"addUser",edit:"editUser"},visits:{list:"getVisits",filter:"getVisitsByFilter"},target:{get:"getDailyTarget",edit:"editDailyTarget"},dashboard:{list:"getDashboradData"}}}},382:function(e,t,a){"use strict";a.r(t);var n=a(155),r=a.n(n),l=a(244),i=a(55),c=a(0),s=a.n(c),o=a(11),d=a(388),m=a(70),u=a(135),p=a(149),b=a.n(p),f=a(138),g=a.n(f),v=a(184),h=a.n(v),E=a(190),w=a.n(E),y=a(199),x=a.n(y),_=a(312),N=a.n(_),D=a(296),F=a.n(D);t.default=function(){var e=Object(c.useState)(null),t=Object(i.a)(e,2),a=t[0],n=t[1],p=Object(c.useState)(null),f=Object(i.a)(p,2),v=f[0],E=f[1],_=Object(c.useState)(0),S=Object(i.a)(_,2),O=(S[0],S[1]),j=Object(c.useState)(!1),C=Object(i.a)(j,2),k=C[0],P=C[1],V=D.Search.SearchBar,B=Object(c.useState)(null),T=Object(i.a)(B,2),I=T[0],M=T[1],L=Object(c.useState)(null),q=Object(i.a)(L,2),A=q[0],U=q[1],Y=function(e){return s.a.createElement("div",null,s.a.createElement("button",{className:"btn btn-success",onClick:function(){console.debug("visits:",A.visits),e.onExport(A.visits)}},"Export Visit Data"))},G=[{dataField:"{rowIndex}",text:"#",formatter:function(e,t,a){return a+1},csvExport:!1},{dataField:"customer_name",text:"Customer Name"},{dataField:"customer_address",text:"Address",hidden:!0},{dataField:"customer_mobile_number",text:"Customer Mobile"},{dataField:"person_type",text:"Buyer Type",hidden:!0},{dataField:"buying_person_name",text:"Buyer Name"},{dataField:"buying_person_mobile_number",text:"Buyer Mobile"},{dataField:"first_name",text:"Salesman Name",formatter:function(e,t){return t.first_name+t.last_name}},{dataField:"mobile_number",text:"Salesman Mobile"},{dataField:"created_on",text:"Visited On",formatter:function(e,t){return new Date(t.created_on).toLocaleString()},filter:Object(y.dateFilter)()},{dataField:"user_id",text:"Detail",formatter:function(e,t,a){return s.a.createElement(o.b,{className:"btn btn-primary",to:{pathname:"".concat("","/pages/visit"),search:"?id=".concat(t.id)}},"Detail")},csvExport:!1},{dataField:"building_area",text:"Building Area",hidden:!0},{dataField:"branch",text:"Branch",hidden:!0},{dataField:"requirement",text:"Requirement",hidden:!0},{dataField:"building_type",text:"Building Type",hidden:!0},{dataField:"is_known",text:"Known Customer",hidden:!0},{dataField:"customer_response",text:"Customer Response",hidden:!0},{dataField:"customer_maycome",text:"Customer Willingness",hidden:!0}];function J(e){return"users"===e?"".concat(u.a.endpoints.basePath).concat(u.a.endpoints.users.list):"filter"===e?"".concat(u.a.endpoints.basePath).concat(u.a.endpoints.visits.filter):"".concat(u.a.endpoints.basePath).concat(u.a.endpoints.visits.list)}function R(e){var t=e.currentTarget;if(!1===t.checkValidity())e.preventDefault(),e.stopPropagation();else{var n=b()(t,{hash:!0});n.from_date="".concat(new Date(a).toISOString().slice(0,10)," 00:00:00"),n.to_date="".concat(new Date(v).toISOString().slice(0,10)," 23:59:59"),console.log("Filter data:",n),g()({url:J("filter"),method:"POST",headers:{},data:n}).then((function(e){"0"==e.data.error?U(e.data):"1"==e.data.error&&alert(e.data.message)})).catch((function(e){})),e.preventDefault()}P(!0)}return Object(c.useEffect)((function(){(function(){var e=Object(l.a)(r.a.mark((function e(){var t,a,l,i,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get(J("users"));case 2:return t=e.sent,M(t.data),e.next=6,g.a.get(J("visits"));case 6:a=e.sent,U(a.data),l=a.data.visits.reduce((function(e,t){return new Date(e)<new Date(t.created_on)?e:t.created_on})),i=new Date(new Date(l).toLocaleString().split(",")[0]),c=new Date,console.debug("Start Date:",i,"End Date:",c),n(i),E(c);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),s.a.createElement("div",null,s.a.createElement("div",{className:"page-header"},s.a.createElement("h3",{className:"page-title"}," Visits "),s.a.createElement("nav",{"aria-label":"breadcrumb"},s.a.createElement("ol",{className:"breadcrumb"},s.a.createElement("li",{className:"breadcrumb-item"},s.a.createElement("a",{href:"!#",onClick:function(e){return e.preventDefault()}},"App")),s.a.createElement("li",{className:"breadcrumb-item active","aria-current":"page"},"Visits")))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-lg-12 grid-margin stretch-card"},s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"card-body"},s.a.createElement("div",{className:"table-responsive"},A&&s.a.createElement(F.a,{keyField:"id",data:null===A||void 0===A?void 0:A.visits,columns:G,search:{defaultSearch:"",searchFormatted:!0},exportCSV:!0},(function(e){return s.a.createElement("div",null,s.a.createElement(d.a,{noValidate:!0,validated:k,onSubmit:R},s.a.createElement("div",{className:"row align-items-center"},s.a.createElement("div",{className:"col-lg-3"},s.a.createElement(d.a.Group,null,s.a.createElement(d.a.Label,null,"Select User"),s.a.createElement("div",{className:"text-right"},s.a.createElement(d.a.Control,{as:"select",name:"user_id",required:!0,defaultValue:"none",onChange:function(e){return O(e.target.value)}},s.a.createElement("option",{key:"0",value:"0"},"All"),null===I||void 0===I?void 0:I.users.map((function(e,t){return s.a.createElement("option",{key:e.user_id,value:e.user_id},e.first_name+e.last_name)})))))),s.a.createElement("div",{className:"col-lg-2"},s.a.createElement(d.a.Group,null,s.a.createElement(d.a.Label,null,"From"),s.a.createElement(N.a,{selected:a,dateFormat:"dd/MM/yyyy",onChange:function(e){return n(e)},className:"form-control",popperPlacement:"bottom-end",showYearDropdown:!0,yearDropdownItemNumber:15,scrollableYearDropdown:!0,name:"from_date",required:!0,autoComplete:"off",customInput:s.a.createElement("input",{type:"text",id:"fromDate",placeholder:"From"})}))),s.a.createElement("div",{className:"col-lg-2"},s.a.createElement(d.a.Group,null,s.a.createElement(d.a.Label,null,"To"),s.a.createElement(N.a,{selected:v,dateFormat:"dd/MM/yyyy",onChange:function(e){return E(e)},className:"form-control",popperPlacement:"bottom-end",name:"to_date",required:!0,autoComplete:"off",showYearDropdown:!0,yearDropdownItemNumber:15,scrollableYearDropdown:!0,customInput:s.a.createElement("input",{type:"text",id:"toDate",placeholder:"To"})}))),s.a.createElement("div",{className:"col-lg-2 text-left align-middle"},s.a.createElement(m.a,{className:"btn btn-block btn-primary btn-lg font-weight-medium auth-form-btn",type:"submit"},"Filter")))),s.a.createElement("hr",null),s.a.createElement("div",{className:"row align-items-center"},s.a.createElement("div",{className:"col-lg-1"},s.a.createElement("h4",{className:"d-inline-flex align-middle"},"Search:")),s.a.createElement("div",{className:"col-lg-6 text-left"},s.a.createElement(V,Object.assign({className:"border border-secondary w-100"},e.searchProps))),s.a.createElement("div",{className:"col-lg-5 text-right"},s.a.createElement(Y,e.csvProps))),s.a.createElement("hr",null),s.a.createElement(h.a,Object.assign({},e.baseProps,{pagination:w()(),filter:x()()})))}))))))))}}}]);
//# sourceMappingURL=15.53f25ee0.chunk.js.map